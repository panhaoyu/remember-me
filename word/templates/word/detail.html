{% extends 'word/base.html' %}

{% block body %}
    <style>
        #translation, #word {
            font-size: 100px;
        }
    </style>
    <div class="container">
        <div class="row">
            <p>操作逻辑：
                1-1 记对了；
                1-2 记错了；
                2-1 完全没记住；
                2-2 完全没记住。</p>
        </div>
        <div id="translation" class="text-center">{{ object.translation }}</div>
        <div id="word" class="text-center"></div>
        <script>
            {# 是否已完成这个单词的操作 #}
            let keys = []
            addEventListener('keyup', ev => {
                switch (ev.key) {
                    case '`':
                        playVoice({{ object.id }})
                        break
                    case '1':
                        keys.push(1)
                        break
                    case '2':
                        keys.push(2)
                        break
                }
                if ('12'.includes(ev.key)) {
                    if (keys.length === 1) {
                        document.querySelector('#word').innerHTML = "{{ object.word }}"
                        playVoice({{ object.id }})
                    } else {
                        {# 将形成三种状态：记住、记错、没印象。 #}
                        if (keys[0] === 1 && keys[1] === 1) {
                            {# 记住的单词，+1分； #}
                            location.pathname = '{% url "word:action" object.id "remember" %}'
                        } else if (keys[0] === 1 && keys[1] === 2) {
                            {# 记错的单词，-2分； #}
                            location.pathname = '{% url "word:action" object.id "forget" %}'
                        } else {
                            {# 没印象的单词，-1分； #}
                            location.pathname = '{% url "word:action" object.id "not-seen" %}'
                        }
                    }
                }
            })
        </script>
    </div>
{% endblock %}
